{"version":3,"file":"VDatePickerMonth.mjs","names":["VBtn","VDefaultsProvider","makeCalendarProps","useCalendar","useDate","computed","ref","shallowRef","genericComponent","propsFactory","makeVDatePickerMonthProps","color","String","hideWeekdays","Boolean","multiple","Number","showWeek","VDatePickerMonth","name","props","emits","date","setup","_ref","emit","slots","daysRef","daysInMonth","model","weekNumbers","adapter","rangeStart","rangeStop","value","length","atMax","max","includes","Infinity","onRangeClick","_value","startOfDay","isSameDay","undefined","isBefore","endOfDay","diff","getDiff","datesInRange","i","nextDate","addDays","push","onMultipleClick","index","findIndex","selection","splice","onClick","_createVNode","_createTextVNode","map","week","getWeekdays","weekDay","item","slotProps","isSelected","isDisabled","isAdjacent","isHidden","isWeekEnd","isWeekStart","isoDate","showAdjacentMonths","class","isToday","disabled","icon","ripple","text","localized","variant","default","day"],"sources":["../../../src/components/VDatePicker/VDatePickerMonth.tsx"],"sourcesContent":["// Styles\nimport './VDatePickerMonth.sass'\n\n// Components\nimport { VBtn } from '@/components/VBtn'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\n\n// Composables\nimport { makeCalendarProps, useCalendar } from '@/composables/calendar'\nimport { useDate } from '@/composables/date/date'\n\n// Utilities\nimport { computed, ref, shallowRef } from 'vue'\nimport { genericComponent, propsFactory } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\nexport type VDatePickerMonthSlots = {\n  day: {\n    props: {\n      onClick: () => void\n    }\n    item: any\n    i: number\n  }\n}\n\nexport const makeVDatePickerMonthProps = propsFactory({\n  color: String,\n  hideWeekdays: Boolean,\n  multiple: [Boolean, Number, String] as PropType<boolean | 'range' | number | (string & {})>,\n  showWeek: Boolean,\n\n  ...makeCalendarProps(),\n}, 'VDatePickerMonth')\n\nexport const VDatePickerMonth = genericComponent<VDatePickerMonthSlots>()({\n  name: 'VDatePickerMonth',\n\n  props: makeVDatePickerMonthProps(),\n\n  emits: {\n    'update:modelValue': (date: unknown) => true,\n    'update:month': (date: number) => true,\n    'update:year': (date: number) => true,\n  },\n\n  setup (props, { emit, slots }) {\n    const daysRef = ref()\n\n    const { daysInMonth, model, weekNumbers } = useCalendar(props)\n    const adapter = useDate()\n\n    const rangeStart = shallowRef()\n    const rangeStop = shallowRef()\n\n    if (props.multiple === 'range' && model.value.length > 0) {\n      rangeStart.value = model.value[0]\n      if (model.value.length > 1) {\n        rangeStop.value = model.value[model.value.length - 1]\n      }\n    }\n\n    const atMax = computed(() => {\n      const max = ['number', 'string'].includes(typeof props.multiple) ? Number(props.multiple) : Infinity\n\n      return model.value.length >= max\n    })\n\n    function onRangeClick (value: unknown) {\n      const _value = adapter.startOfDay(value)\n\n      if (!rangeStart.value) {\n        rangeStart.value = _value\n        model.value = [rangeStart.value]\n      } else if (!rangeStop.value) {\n        if (adapter.isSameDay(_value, rangeStart.value)) {\n          rangeStart.value = undefined\n          model.value = []\n          return\n        } else if (adapter.isBefore(_value, rangeStart.value)) {\n          rangeStop.value = adapter.endOfDay(rangeStart.value)\n          rangeStart.value = _value\n        } else {\n          rangeStop.value = adapter.endOfDay(_value)\n        }\n\n        const diff = adapter.getDiff(rangeStop.value, rangeStart.value, 'days')\n        const datesInRange = [rangeStart.value]\n\n        for (let i = 1; i < diff; i++) {\n          const nextDate = adapter.addDays(rangeStart.value, i)\n          datesInRange.push(nextDate)\n        }\n\n        datesInRange.push(rangeStop.value)\n\n        model.value = datesInRange\n      } else {\n        rangeStart.value = value\n        rangeStop.value = undefined\n        model.value = [rangeStart.value]\n      }\n    }\n\n    function onMultipleClick (value: unknown) {\n      const index = model.value.findIndex(selection => adapter.isSameDay(selection, value))\n\n      if (index === -1) {\n        model.value = [...model.value, value]\n      } else {\n        const value = [...model.value]\n        value.splice(index, 1)\n        model.value = value\n      }\n    }\n\n    function onClick (value: unknown) {\n      if (props.multiple === 'range') {\n        onRangeClick(value)\n      } else if (props.multiple) {\n        onMultipleClick(value)\n      } else {\n        model.value = [value]\n      }\n    }\n\n    return () => (\n      <div class=\"v-date-picker-month\">\n        { props.showWeek && (\n          <div key=\"weeks\" class=\"v-date-picker-month__weeks\">\n            { !props.hideWeekdays && (\n              <div key=\"hide-week-days\" class=\"v-date-picker-month__day\">&nbsp;</div>\n            )}\n            { weekNumbers.value.map(week => (\n              <div\n                class={[\n                  'v-date-picker-month__day',\n                  'v-date-picker-month__day--adjacent',\n                ]}\n              >{ week }</div>\n            ))}\n          </div>\n        )}\n\n        <div\n          ref={ daysRef }\n          class=\"v-date-picker-month__days\"\n        >\n          { !props.hideWeekdays && adapter.getWeekdays().map(weekDay => (\n            <div\n              class={[\n                'v-date-picker-month__day',\n                'v-date-picker-month__weekday',\n              ]}\n            >{ weekDay }</div>\n          ))}\n\n          { daysInMonth.value.map((item, i) => {\n            const slotProps = {\n              props: {\n                onClick: () => onClick(item.date),\n              },\n              item,\n              i,\n            } as const\n\n            if (atMax.value && !item.isSelected) {\n              item.isDisabled = true\n            }\n\n            return (\n              <div\n                class={[\n                  'v-date-picker-month__day',\n                  {\n                    'v-date-picker-month__day--adjacent': item.isAdjacent,\n                    'v-date-picker-month__day--hide-adjacent': item.isHidden,\n                    'v-date-picker-month__day--selected': item.isSelected,\n                    'v-date-picker-month__day--week-end': item.isWeekEnd,\n                    'v-date-picker-month__day--week-start': item.isWeekStart,\n                  },\n                ]}\n                data-v-date={ !item.isDisabled ? item.isoDate : undefined }\n              >\n\n                { (props.showAdjacentMonths || !item.isAdjacent) && (\n                  <VDefaultsProvider\n                    defaults={{\n                      VBtn: {\n                        class: 'v-date-picker-month__day-btn',\n                        color: (item.isSelected || item.isToday) && !item.isDisabled\n                          ? props.color\n                          : undefined,\n                        disabled: item.isDisabled,\n                        icon: true,\n                        ripple: false,\n                        text: item.localized,\n                        variant: item.isDisabled\n                          ? item.isToday ? 'outlined' : 'text'\n                          : item.isToday && !item.isSelected ? 'outlined' : 'flat',\n                        onClick: () => onClick(item.date),\n                      },\n                    }}\n                  >\n                    { slots.day?.(slotProps) ?? (\n                      <VBtn { ...slotProps.props } />\n                    )}\n                  </VDefaultsProvider>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  },\n})\n\nexport type VDatePickerMonth = InstanceType<typeof VDatePickerMonth>\n"],"mappings":"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","ignoreList":[]}